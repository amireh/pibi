<% content_for :deferred_js do %>
  <script>
    $(function() {
      $("nav li a[id='nav_<%=current_page%>']").addClass("highlighted");
    })
  </script>
<% end %>

<div class="stuff">
  <header>
    <h1><a href="/"><%= AppName %></a></h1>
    <div class="subheader">
      <span class="account_balance">Balance:
        <span class="<%= current_account.balance > 0 ? 'positive' : 'negative' %>"><%= current_account.balance.to_f %></span> <%= current_account.currency %>
      </span>
      <span class="account_name">
        <% if current_user.is_admin %>
          <a href="/admin">Admin</a>
        <% end %>
        <%= current_user.name %>
        <a href="/settings/account">
          <%= gravatar_tag current_user.gravatar_email, :icon %>
        </a>
        <% if current_user.notice_count > 0 %>
          <a href="/settings/notifications">
            <span class="notifications blinky" title="You have <%= current_user.notice_count %> pending notifications">
              <%= current_user.notice_count %>
            </span>
          </a>
        <% end %>
      </span>
      <% yield_content :subheader %>
      <%= partial "layouts/_flashes" %>
    </div>
  </header>

  <nav>
    <div class="left tri"></div>
    <ol>
      <li><a id="nav_transactions" href="/" title="Your last month's activity">Transactions</a></li>
      <li><a id="nav_deposits" href="/transactions/deposits/new" title="Track some money you earned">Deposit</a></li>
      <li><a id="nav_withdrawals" href="/transactions/withdrawals/new" title="Track something you spent">Withdraw</a></li>
      <li><a id="nav_recurrings" href="/transactions/recurrings/new" title="Track a bill or salary">Recurring</a></li>
      <li><a id="nav_reports" class="listlike" href="/reports">Reports<span>&darr;</span></a>
        <ol>
          <li><a href="/reports/yearly">Yearly reports</a></li>
          <li><a href="/reports/monthly">Monthly reports</a></li>
        </ol>
      </li>
      <li><a id="nav_manage" class="listlike" href="/manage">Manage<span>&darr;</span></a>
        <ol>
          <li><a href="/categories">Categories</a></li>
          <li><a href="/transactions/recurrings">Bills</a></li>
          <li><a href="/settings/account">Account</a></li>
          <li><a href="/sessions/destroy">Sign out</a></li>
        </ol>
      </li>
    </ol>
    <div class="right tri"></div>
  </nav>

  <div id="content" class="<%= request.path.gsub('/', ' ').strip.sanitize.split('-').first %>">
    <%= yield_content :content %>
  </div>

  <%= partial "footer" %>
</div>
